(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/uni-im-msg-list/uni-im-msg-list"],{"03dc":function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"c",(function(){return i})),e.d(n,"a",(function(){return o}));var o={uniIcons:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(e.bind(null,"06f3"))},uniImFormatTime:function(){return e.e("components/uni-im-format-time/uni-im-format-time").then(e.bind(null,"4567"))},uniImMsg:function(){return Promise.all([e.e("common/vendor"),e.e("components/uni-im-msg/uni-im-msg")]).then(e.bind(null,"f71d"))},uniLoadMore:function(){return Promise.all([e.e("common/vendor"),e.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(e.bind(null,"345c"))}},r=function(){var t=this.$createElement,n=(this._self._c,this.msgList.length),e=this.currentConversationId&&0==this.msgList.length,o=e?{contentrefresh:"加载中",contentnomore:"- 没有聊天记录 -"}:null;this.$mp.data=Object.assign({},{$root:{g0:n,g1:e,a0:o}})},i=[]},"791f":function(t,n,e){},a987:function(t,n,e){"use strict";e.r(n);var o=e("bd9c"),r=e.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){e.d(n,t,(function(){return o[t]}))}(i);n["default"]=r.a},b9b6:function(t,n,e){"use strict";var o=e("791f"),r=e.n(o);r.a},bd9c:function(t,n,e){"use strict";var o=e("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=o(e("2eee")),i=o(e("c973")),s=o(e("9523")),a=e("26cb"),u=e("58c5"),c=o(e("8a41"));function l(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function f(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?l(Object(e),!0).forEach((function(n){(0,s.default)(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):l(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var d={components:{uniImList:function(){e.e("components/uni-im-msg-list/components/uni-im-list/uni-im-list").then(function(){return resolve(e("f93a"))}.bind(null,e)).catch(e.oe)},uniImListItem:function(){e.e("components/uni-im-msg-list/components/uni-im-list-item/uni-im-list-item").then(function(){return resolve(e("f486"))}.bind(null,e)).catch(e.oe)}},computed:f(f(f({},(0,a.mapState)({currentConversationId:function(t){return t.uniIm.currentConversationId},systemInfo:function(t){return t.uniIm.systemInfo},isWidescreen:function(t){return t.uniIm.isWidescreen},msgList:function(t){return t.uniIm.msgList}})),(0,a.mapGetters)({conversation:"uniIm/conversation"})),{},{loadState:function(){return this.hasMore?"正在加载历史消息":"没有更多历史消息"},current_uid:function(){return u.store.userInfo._id},currentConversation:function(){return this.conversation(this.currentConversationId)||{}},msgManagers:function(){var t=getApp().globalData.uniIm.msgManagers,n=t[this.currentConversationId];return n||(t[this.currentConversationId]=new c.default(this.currentConversation)),t[this.currentConversationId]||{}},isSafariPc:function(){return!1}}),props:{paddingBottom:{default:""}},data:function(){return{scrollIntoView:"",scrollTop:0,old:{scrollTop:0},hasMore:!1,tasksList:[]}},mounted:function(){return(0,i.default)(r.default.mark((function t(){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},methods:f(f({init:function(){var t=this;return(0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.scrollIntoView="",t.scrollTop=0,t.old.scrollTop=0,t.hasMore=!0,t.tasksList=[],t.loadMore.lock=!1,t.msgList){n.next=14;break}return console.log("sss"),n.next=10,t.loadMore();case 10:t.tasksList.push((0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.showLast(300),t.updateConversation([t.currentConversationId,{isInit:!0}]);case 2:case"end":return n.stop()}}),n)})))),t.doTasksListBefore(),n.next=15;break;case 14:t.msgList.length<t.msgManagers.pageLimit&&(t.hasMore=!1);case 15:case"end":return n.stop()}}),n)})))()},loadMore:function(){var t=this;return(0,i.default)(r.default.mark((function n(){var e;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.loadMore.lock&&t.hasMore){n.next=2;break}return n.abrupt("return",[]);case 2:return t.loadMore.lock=!0,n.next=5,t.msgManagers.getMore();case 5:return e=n.sent,t.hasMore=0!=e.length,t.tasksList.push((function(){t.setMsgList({conversation_id:t.currentConversationId,action:t.currentConversation.isInit?"unshift":"set",data:e}),t.$nextTick((0,i.default)(r.default.mark((function n(){return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.loadMore.lock=!1,!(t.msgList.length<t.msgManagers.pageLimit&&t.hasMore)){n.next=5;break}return t.loadMore.lock=!1,n.next=5,t.loadMore();case 5:case"end":return n.stop()}}),n)}))))})),t.doTasksListBefore(),n.abrupt("return",e);case 10:case"end":return n.stop()}}),n)})))()},doTasksListBefore:function(){var t=this;if(this.tasksList.length){if(this.old.scrollTop<1&&!this.isSafariPc)return this.scrollTop=this.old.scrollTop,this.$nextTick((function(){t.scrollTop=1,t.old.scrollTop=1,setTimeout((function(){t.doTasksList()}),300)}));this.doTasksList()}},doTasksList:function(){this.tasksList.forEach((function(t){return t()})),this.tasksList=[]},showLast:function(){var t=this;this.$nextTick((function(){t.scrollIntoView="uni-im-list-last-item",t.$nextTick((function(){t.scrollIntoView=""}))}))},onScroll:function(t){var n=this;this.old.scrollTop=t.detail.scrollTop,t.detail.scrollTop<300&&this.loadMore(),function(t,n){return function(){m.length&&m.forEach((function(t){return clearTimeout(t)}));var e=setTimeout(t,n);m.push(e)}}((function(){n.doTasksListBefore,setTimeout((function(){t.detail.scrollTop<300&&n.loadMore()}),1500)}))()},showControl:function(t){this.$emit("showControl",t)},retriesSendMsg:function(t){this.$emit("retriesSendMsg",t)}},(0,a.mapActions)({getConversation:"uniIm/getConversation",clearUnreadCount:"uniIm/clearUnreadCount",setMsgList:"uniIm/setMsgList",getMsgManager:"uniIm/getMsgManager",loadConversation:"uniIm/loadMoreConversation"})),(0,a.mapMutations)({setCurrentConversationId:"uniIm/setCurrentConversationId",updateConversation:"uniIm/updateConversation",updateMsgManager:"uniIm/updateMsgManager",addMsgManager:"uniIm/addMsgManager"}))};n.default=d;var m=[]},f93e:function(t,n,e){"use strict";e.r(n);var o=e("03dc"),r=e("a987");for(var i in r)["default"].indexOf(i)<0&&function(t){e.d(n,t,(function(){return r[t]}))}(i);e("b9b6");var s=e("f0c5"),a=Object(s["a"])(r["default"],o["b"],o["c"],!1,null,"0b07ea52",null,!1,o["a"],void 0);n["default"]=a.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/uni-im-msg-list/uni-im-msg-list-create-component',
    {
        'components/uni-im-msg-list/uni-im-msg-list-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("f93e"))
        })
    },
    [['components/uni-im-msg-list/uni-im-msg-list-create-component']]
]);
