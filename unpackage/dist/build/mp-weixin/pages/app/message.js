(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/app/message"],{"2e6b":function(t,e,a){},"5f2f":function(t,e,a){"use strict";var n=a("2e6b"),i=a.n(n);i.a},"79e6":function(t,e,a){"use strict";a.r(e);var n=a("be1a"),i=a("afc8");for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("5f2f");var r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=s.exports},"86dc":function(t,e,a){"use strict";(function(t,e){var n=a("4ea4");a("3f59"),a("a9ff");n(a("66fd"));var i=n(a("79e6"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(i.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])},afc8:function(t,e,a){"use strict";a.r(e);var n=a("db30"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},be1a:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={uniDateformat:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat")]).then(a.bind(null,"23e3"))}},i=function(){var t=this.$createElement;this._self._c},o=[]},db30:function(t,e,a){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=t.database(),i=(n.collection("tian-mall-message"),{data:function(){return{type:"",cachePreKey:"message_list_",dataList:[]}},computed:{isLogin:function(){return this.$store.getters["user/isTokenValid"]},userInfo:function(){return this.$store.state.user.userInfo}},onLoad:function(t){t.title&&a.setNavigationBarTitle({title:t.title}),this.type=t.type,this.loadData()},methods:{loadData:function(){var t=this,e="".concat(this.cachePreKey).concat(this.userInfo._id,"_").concat(this.type);this.isLogin&&(this.dataList=a.getStorageSync(e),this.dataList||(this.dataList=[]),n.collection("tian-mall-message").where('user_id==$cloudEnv_uid&&type=="'.concat(this.type,'"')).orderBy("create_date desc").limit(500).get().then((function(n){var i=n.result;console.log("messageList",i.data),t.dataList=i.data,a.setStorage({key:e,data:i.data})})))},readItem:function(t){if(t.url,t.read)return!0;t.read=!0,n.collection("tian-mall-message").where('user_id==$cloudEnv_uid && _id=="'.concat(t._id,'"')).update({read:!0});var e="message_pre_".concat(this.userInfo._id,"_").concat(t.type);a.getStorage({key:e,success:function(n){var i=n.data;i&&(i.badge>0&&(i.badge=i.badge-1),i._id==t._id&&(i.read=!0),a.setStorageSync(e,i))}}),this.$success("消息已读")}}});e.default=i}).call(this,a("a9ff")["default"],a("543d")["default"])}},[["86dc","common/runtime","common/vendor"]]]);