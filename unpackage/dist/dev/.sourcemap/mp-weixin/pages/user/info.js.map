{"version":3,"sources":["uni-app:///main.js","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/user/info.vue?4374","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/user/info.vue?07af","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/user/info.vue?0c7b","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/user/info.vue?19c5","uni-app:///pages/user/info.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","cachekey","isBindWx","info","onLoad","uni","key","console","computed","userInfo","cashoutTypes","enableWxpay","enableBank","enableAlipay","customer","mobileStatusText","bankStatusText","alipayStatusText","wxStatusText","methods","cancellation","showModal","loading","title","content","cancelText","confirmText","success","url","localLogout","token","tokenExpired","bindWeixinH5","window","bindWeixin","provider","loginRes","bind","fail","changeNickname","confirmEditNickname","nickname","changeAvatar","count","sizeType","sourceType","crop","quality","width","height","editData"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,aAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;;;AAGnD;AAC+K;AAC/K,gBAAgB,wLAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,uPAEN;AACP,KAAK;AACL;AACA,aAAa,qRAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAAgpB,CAAgB,qqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;ACyCpqB;AAAA;AAAA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAC;MACAC;MACAN;IACA;IAEAO;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;QAAA;MAAA;IACA;IACAC;MACA;QAAA;MAAA;IACA;IACAC;MACA;QAAA;MAAA;IACA;IACAC;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MAOA;QACA;QACA;MACA;MACA;IACA;EACA;EACAC;IACAC;MAAA;MACA;QACA;UACAC;UACAC;QACA;UACA;UACA;QACA;UACAjB;YACAkB;YACAC;YACAC;YACAC;YACAC;cACA;gBACAtB;kBACAuB;gBACA;cACA;YACA;UACA;QACA;MACA;IACA;IACAC;MAAA;MACA;MACA;MACA;MACA;QACA7B;UAAA;QAAA;MACA;MACAK;MACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;QACA;QACA;QACA;UACAyB;UACAC;UACAtB;QACA;MACA;MACAJ;MAEAA;MACA;MAEA;IACA;IACA2B;MACA;MACA;QACA;MACA;MACA;QACAC;MACA;IACA;IACAC;MAAA;MACA;MACA;QACA;MACA;MACA7B;QACA8B;QACAR;UACApB;UACA,2DACA6B,WACA;YACAd;UACA;YACA;YACAf;YACA;YACA;UACA;QACA;MACA;IACA;IACA8B;MAAA;MACA9B;MACAF;QACA8B;QACAR;UACApB;UACA;YACA4B;UAAA,GACAC,WACA;YACAd;UACA;YACA;YACAf;YACA;YACA;UACA;QACA;QACA+B;UACA/B;UACA;QACA;MACA;IACA;IACAgC;MACA;IACA;IACAC;MACA;QACAC;MACA;IACA;IACAC;MACArC;QACAsC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;UACAC;UACAC;UACAC;QACA;QACAtB;UACApB;UACA;YACAF;cACAC;cACAN;YACA;YAEAK;cACAuB;YACA;UAsBA;QACA;MACA;IACA;IACAsB;MAAA;MACA3C;MACA;QACAe;MACA;QACA;QACA;MACA;MACA;AACA;AACA;IACA;EACA;AACA;AAAA,2B","file":"pages/user/info.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/user/info.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./info.vue?vue&type=template&id=4b89896e&\"\nvar renderjs\nimport script from \"./info.vue?vue&type=script&lang=js&\"\nexport * from \"./info.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/user/info.vue\"\nexport default component.exports","export * from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./info.vue?vue&type=template&id=4b89896e&\"","var components\ntry {\n  components = {\n    uniList: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-list/components/uni-list/uni-list\" */ \"@/uni_modules/uni-list/components/uni-list/uni-list.vue\"\n      )\n    },\n    uniListItem: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-list/components/uni-list-item/uni-list-item\" */ \"@/uni_modules/uni-list/components/uni-list-item/uni-list-item.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./info.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./info.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<uni-list>\r\n\t\t\t<uni-list-item title=\"头像\" :showArrow=\"true\" :clickable=\"true\" @click=\"changeAvatar\">\r\n\t\t\t\t<template slot=\"footer\">\r\n\t\t\t\t\t<image class=\"image-width-50 border-radius\" :src=\"userInfo.avatar\" mode=\"aspectFill\"></image>\r\n\t\t\t\t</template>\r\n\t\t\t</uni-list-item>\r\n\t\t\t<uni-list-item title=\"昵称\" :showArrow=\"true\" :clickable=\"true\" @click=\"navTo('/pages/user/edit/nickname')\"\r\n\t\t\t\t:rightText=\"userInfo.nickName\">\r\n\t\t\t</uni-list-item>\r\n\t\t\t<uni-list-item v-if=\"userInfo.channel_code\" title=\"渠道\" :rightText=\"userInfo.channel_code\">\r\n\t\t\t</uni-list-item>\r\n\t\t\t<!-- #ifdef APP-PLUS -->\r\n\t\t\t<uni-list-item v-if=\"enableWxpay\" title=\"微信\" :showArrow=\"true\" :clickable=\"true\" @click=\"bindWeixin\"\r\n\t\t\t\t:rightText=\"wxStatusText\">\r\n\t\t\t</uni-list-item>\r\n\t\t\t<uni-list-item v-if=\"enableBank\" title=\"绑定银行卡\" :showArrow=\"true\" :clickable=\"true\"\r\n\t\t\t\t@click=\"navTo('/pages/user/bind/bankcard')\" :rightText=\"bankStatusText\">\r\n\t\t\t</uni-list-item>\r\n\t\t\t<uni-list-item v-if=\"enableAlipay\" title=\"绑定支付宝\" :showArrow=\"true\" :clickable=\"true\"\r\n\t\t\t\t@click=\"navTo('/pages/user/bind/alipay')\" :rightText=\"alipayStatusText\">\r\n\t\t\t</uni-list-item>\r\n\t\t\t<!-- #endif -->\r\n\t\t\t<!-- #ifdef H5 -->\r\n\t\t\t<uni-list-item v-if=\"enableWxpay\" title=\"绑定微信\" :showArrow=\"true\" :clickable=\"true\" @click=\"bindWeixinH5\"\r\n\t\t\t\t:rightText=\"wxStatusText\">\r\n\t\t\t</uni-list-item>\r\n\t\t\t<!-- #endif -->\r\n\t\t\t<!-- #ifdef MP -->\r\n\t\t\t<uni-list-item title=\"绑定手机\" :showArrow=\"true\" :clickable=\"true\" @click=\"navTo('/pages/login/bindmobile')\"\r\n\t\t\t\t:rightText=\"mobileStatusText\">\r\n\t\t\t</uni-list-item>\r\n\t\t\t<!-- #endif -->\r\n\t\t\t<uni-list-item title=\"注销账号\" :showArrow=\"true\" :clickable=\"true\" @click=\"cancellation\" rightText=\"注销后不能恢复\">\r\n\t\t\t</uni-list-item>\r\n\t\t</uni-list>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport { cloudUploadFile } from \"@/common/mixin/upload.js\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcachekey: 'tiantian-accounts',\r\n\t\t\t\tisBindWx: false,\r\n\t\t\t\tinfo: {},\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tuni.setStorage({\r\n\t\t\t\tkey: \"avatarField\",\r\n\t\t\t\tdata: \"avatar\"\r\n\t\t\t})\r\n\r\n\t\t\tconsole.log(this.cashoutTypes)\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tuserInfo() {\r\n\t\t\t\treturn this.$store.state.user.userInfo;\r\n\t\t\t},\r\n\t\t\tcashoutTypes() {\r\n\t\t\t\treturn this.userInfo.cashoutType\r\n\t\t\t},\r\n\t\t\tenableWxpay() {\r\n\t\t\t\treturn this.cashoutTypes && this.cashoutTypes.filter(e => e.value == \"wxpay\").length > 0\r\n\t\t\t},\r\n\t\t\tenableBank() {\r\n\t\t\t\treturn this.cashoutTypes && this.cashoutTypes.filter(e => e.value == \"bank\").length > 0\r\n\t\t\t},\r\n\t\t\tenableAlipay() {\r\n\t\t\t\treturn this.cashoutTypes && this.cashoutTypes.filter(e => e.value == \"alipay\").length > 0\r\n\t\t\t},\r\n\t\t\tcustomer() {\r\n\t\t\t\treturn this.$store.state.app.customer;\r\n\t\t\t},\r\n\t\t\tmobileStatusText() {\r\n\t\t\t\tif (this.userInfo.mobile) {\r\n\t\t\t\t\treturn this.userInfo.mobile;\r\n\t\t\t\t}\r\n\t\t\t\treturn \"去绑定\";\r\n\t\t\t},\r\n\t\t\tbankStatusText() {\r\n\t\t\t\tif (this.userInfo.bankinfo) {\r\n\t\t\t\t\t//银行名称\r\n\t\t\t\t\treturn this.userInfo.bankinfo.title;\r\n\t\t\t\t}\r\n\t\t\t\treturn \"去绑定\";\r\n\t\t\t},\r\n\t\t\talipayStatusText() {\r\n\t\t\t\tif (this.userInfo.alipayinfo) {\r\n\t\t\t\t\treturn this.userInfo.alipayinfo.name;\r\n\t\t\t\t}\r\n\t\t\t\treturn \"去绑定\";\r\n\t\t\t},\r\n\t\t\twxStatusText() {\r\n\t\t\t\t//#ifdef H5\r\n\t\t\t\tif (this.userInfo.wx_openid && this.userInfo.wx_openid[\"h5\"]) {\r\n\t\t\t\t\tthis.isBindWx = true;\r\n\t\t\t\t\treturn \"已绑定\"\r\n\t\t\t\t}\r\n\t\t\t\t//#endif\r\n\t\t\t\tif (this.userInfo.wx_openid && this.userInfo.wx_openid[\"app-plus\"]) {\r\n\t\t\t\t\tthis.isBindWx = true;\r\n\t\t\t\t\treturn \"已绑定\"\r\n\t\t\t\t}\r\n\t\t\t\treturn \"去绑定\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tcancellation() {\r\n\t\t\t\tthis.confirmAction(() => {\r\n\t\t\t\t\tthis.$request('user/info/cancellation', {}, {\r\n\t\t\t\t\t\tshowModal: false,\r\n\t\t\t\t\t\tloading: true\r\n\t\t\t\t\t}).then(() => {\r\n\t\t\t\t\t\tthis.$success(\"注销成功\")\r\n\t\t\t\t\t\tthis.localLogout();\r\n\t\t\t\t\t}, (err) => {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\ttitle: \"注销失败\",\r\n\t\t\t\t\t\t\tcontent: err.message + \"\\n请联系客服协助处理\",\r\n\t\t\t\t\t\t\tcancelText: \"放弃注销\",\r\n\t\t\t\t\t\t\tconfirmText: \"找客服\",\r\n\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\t\turl: \"/pages/app/contact\"\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}, \"请确认您已经准备放弃本账户？若不满足自主注销条件请联系客服协助完成\", \"温馨提示\")\r\n\t\t\t},\r\n\t\t\tlocalLogout() {\r\n\t\t\t\tlet data = [];\r\n\t\t\t\t//移除accounts\r\n\t\t\t\tthis.dataList = uni.getStorageSync(this.cachekey);\r\n\t\t\t\tif (this.dataList && this.dataList.length > 1) {\r\n\t\t\t\t\tdata = this.dataList.filter(e => e._id != this.userInfo._id);\r\n\t\t\t\t}\r\n\t\t\t\tuni.setStorageSync(this.cachekey, data);\r\n\t\t\t\tif (data.length == 0) {\r\n\t\t\t\t\t//移除本地token\r\n\t\t\t\t\tthis.$store.commit('user/REMOVE_TOKEN');\r\n\t\t\t\t\t//重置用户信息\r\n\t\t\t\t\tthis.$store.commit('user/SET_USER_INFO', {});\r\n\t\t\t\t\t//清空购物车\r\n\t\t\t\t\tthis.$store.commit('mall/UPDATE_CART_NUMBER', 0);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet item = data[0];\r\n\t\t\t\t\t//切换到第一个\r\n\t\t\t\t\tthis.$store.commit('user/SET_TOKEN', {\r\n\t\t\t\t\t\ttoken: item.token,\r\n\t\t\t\t\t\ttokenExpired: item.tokenExpired,\r\n\t\t\t\t\t\tuserInfo: item,\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\t// #ifdef MP\r\n\t\t\t\tuni.exitMiniProgram()\r\n\t\t\t\treturn;\r\n\t\t\t\t// #endif\r\n\t\t\t\tthis.navTimeBack(false, 100);\r\n\t\t\t},\r\n\t\t\tbindWeixinH5() {\r\n\t\t\t\t//是否需要解绑微信\r\n\t\t\t\tif (this.isBindWx) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.customer.wx_auth) {\r\n\t\t\t\t\twindow.location.href = this.customer.wx_auth;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbindWeixin() {\r\n\t\t\t\t//是否需要解绑微信\r\n\t\t\t\tif (this.isBindWx) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tuni.login({\r\n\t\t\t\t\tprovider: \"weixin\",\r\n\t\t\t\t\tsuccess: (loginRes) => {\r\n\t\t\t\t\t\tconsole.log('授权code', loginRes);\r\n\t\t\t\t\t\tthis.$request('user/info/bind_weixin', {\r\n\t\t\t\t\t\t\t...loginRes\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tloading: true\r\n\t\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\t\t//设置成功,刷新用户信息\r\n\t\t\t\t\t\t\tconsole.log(\"bind_weixin\", res)\r\n\t\t\t\t\t\t\t//刷新用户信息\r\n\t\t\t\t\t\t\tthis.$store.dispatch('user/getUserInfo');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tbind(provider) {\r\n\t\t\t\tconsole.log(\"bind \" + provider)\r\n\t\t\t\tuni.login({\r\n\t\t\t\t\tprovider: provider,\r\n\t\t\t\t\tsuccess: (loginRes) => {\r\n\t\t\t\t\t\tconsole.log('授权code', loginRes);\r\n\t\t\t\t\t\tthis.$request('user/info/bind', {\r\n\t\t\t\t\t\t\tprovider: provider,\r\n\t\t\t\t\t\t\t...loginRes\r\n\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\tloading: true\r\n\t\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\t\t//设置成功,刷新用户信息\r\n\t\t\t\t\t\t\tconsole.log(\"bind \" + provider, res)\r\n\t\t\t\t\t\t\t//刷新用户信息\r\n\t\t\t\t\t\t\tthis.$store.dispatch('user/getUserInfo');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (e) => {\r\n\t\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\t\tthis.$message(\"授权失败\")\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchangeNickname() {\r\n\t\t\t\tthis.$refs.nicknamePopup.open()\r\n\t\t\t},\r\n\t\t\tconfirmEditNickname(value) {\r\n\t\t\t\tthis.editData({\r\n\t\t\t\t\tnickname: value\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchangeAvatar() {\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1, //默认9\r\n\t\t\t\t\tsizeType: ['compressed'], //可以指定是原图还是压缩图，默认二者都有\r\n\t\t\t\t\tsourceType: ['camera', 'album'], //从相册选择\r\n\t\t\t\t\tcrop: {\r\n\t\t\t\t\t\tquality: 5,\r\n\t\t\t\t\t\twidth: 200,\r\n\t\t\t\t\t\theight: 200\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\tif (res.tempFilePaths.length > 0) {\r\n\t\t\t\t\t\t\tuni.setStorage({\r\n\t\t\t\t\t\t\t\tkey: 'avatar',\r\n\t\t\t\t\t\t\t\tdata: res.tempFilePaths[0]\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t//#ifndef APP-PLUS\r\n\t\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\t\turl: '/pages/user/avatar'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t//#endif\r\n\t\t\t\t\t\t\t//#ifdef APP-PLUS\r\n\t\t\t\t\t\t\t//上传文件并保存\r\n\t\t\t\t\t\t\tcloudUploadFile(res.tempFilePaths[0]).then(url => {\r\n\t\t\t\t\t\t\t\tconsole.log(\"url\", url)\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tthis.editData({\r\n\t\t\t\t\t\t\t\t\t\tavatar: url\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\t\tconsole.log(\"getOpenerEventChannel fail\", e)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis.$success('修改成功');\r\n\t\t\t\t\t\t\t}, err => {\r\n\t\t\t\t\t\t\t\tthis.isSubmit = false;\r\n\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\ttitle: '修改失败',\r\n\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t//#endif\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\teditData(data) {\r\n\t\t\t\tconsole.log(\"editData\", data)\r\n\t\t\t\tthis.$request(\"user/info/edit\", data, {\r\n\t\t\t\t\tloading: true\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\t//设置成功,刷新用户信息\r\n\t\t\t\t\tthis.$store.dispatch('user/getUserInfo');\r\n\t\t\t\t})\r\n\t\t\t\t/* for (let key in data) {\r\n\t\t\t\t\tthis.$set(this.info, key, data[key])\r\n\t\t\t\t} */\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\r\n</style>\n"],"sourceRoot":""}