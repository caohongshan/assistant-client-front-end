{"version":3,"sources":["uni-app:///main.js","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/product/detail.vue?a28d","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/product/detail.vue?254b","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/product/detail.vue?e622","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/product/detail.vue?104f","uni-app:///pages/product/detail.vue","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/product/detail.vue?3266","webpack:///H:/private/AIproject/psychic/assistant-client-front-end/pages/product/detail.vue?811f"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","mixins","components","groupBuyingPage","data","preloaded","loaded","current","bottomOptions","buttonGroup","selectSku","defaultSkuId","group_buying_id","item","description","defaultPrice","allGroupBuying","groupBuying","groupBuyingTotal","maxShowAllGroupBuying","isSubmitSku","onLoad","onPullDownRefresh","console","uni","onShow","computed","quanyiDescription","customer","priceDescription","bottomStyle","bottom","methods","showCoupon","getCoupon","id","shop_id","loading","content","showCancel","success","closeCoupon","loadData","db","where","getOne","result","type","contents","goods","buildData","getGroupBuying","field","then","dataMap","avatar","nickname","enable","index","amount","gb","updateBottomOptions","icon","text","options","color","backgroundColor","checkFav","get","saveFav","title","price","change","resetTabCartCount","leftClick","url","buttonClick","openSku","changeSku","showMoreGb","closeGb","changeGb","btnGroupBuying"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;AACc;;;AAGnE;AAC+K;AAC/K,gBAAgB,wLAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,0SAEN;AACP,KAAK;AACL;AACA,aAAa,sQAEN;AACP,KAAK;AACL;AACA,aAAa,oVAEN;AACP,KAAK;AACL;AACA,aAAa,8RAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACxEA;AAAA;AAAA;AAAA;AAAkpB,CAAgB,uqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACqLtqB;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAHA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAIA;EACAC;EACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACA;IACA;MACA;IACA;IACA;MACA;MACA;IACA;IACA;MACA;IACA;IACA;IACA;MACA;MACA;IACA;IACA;IACA;MACA;IACA;IACA;EACA;EACA;EACAC;IACAC;IACAC;IACA;IACA;IACA;EACA;EACAC;IACA;MACA;IACA;EACA;EACAC;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;QACAC;QACA;UACAA;QACA;QACAA;MACA;MACA;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MAAA;MACA,cACA;QACAC;QACAC;MACA;QACAC;MACA,EACA,MACA;QACAb;UACAc;UACAC;UACAC;YACA;UACA;QACA;MACA,GACA;QACAhB;UACAc;UACAC;UACAC;YACA;UACA;QACA;MACA,EACA;IACA;IACAC;MACA;IACA;IACAC;MAAA;MACAC,uHACAC,uBACA,4BACA,qXACA;QACAC;MACA,wBAEA;QAAA,IADAC;QAEA;QACA;QACA;UACA;UACA;UACA;UACA;UACAA;YACA;cACA;gBACA;kBACA;oBACAC;oBACAT;kBACA;gBACA;gBACAU;gBACA;kBACAD;kBACAT;gBACA;gBACA;cACA;cACA;cACAU;cACA;YACA;YACAA;UACA;UACA;YACA;cACAD;cACAT;YACA;UACA;UACAf;QACA;QACA;QACA;UACAuB;QACA;QACA;QACA;UACAA;UACAA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;UACAG;QACA;MACA;MACA;MACA,8FACA9B;QACA;MACA;IACA;IACA+B;MAAA;MACA;MACA;QACA;UACA;QACA;MACA;IACA;IACA;AACA;AACA;IACAC;MAAA;MACA;QACA;MACA;MACA;MACAR,yFACA,kCACAS,MACA,kGACAC,sBAEA;QAAA,IADAP;QAEAvB;QACA;QACA;QACA;QACAuB;UACA;UACA;UACA;YACAQ;cACAC;cACAC;cACArB;cACAsB;cACAC;cACAC;YACA;UACA;UACAL;UACA;UACA;YACAA;YACAA;UACA;UACAA;UACAA;UACAA;UACA;QACA;QACA;QACA;QACA;QACA;UACA;YACA;UACA;QACA;QACA;QACA;UACA;QACA;QACA;QACA;UACA;YACAM;UACA;QACA;QACA;QACA;MACA;IACA;IACAC;MACA;QACAC;QACAC;MACA;MACA;QACA;UACAC;YACAF;YACAG;YACAF;UACA;QACA;UACAC;YACAF;YACAG;YACAF;UACA;QACA;MACA;MACAC;QACAF;QACAC;QACA;MACA;;MACA;MACA;QACA;UACAA;UACAG;UACAD;QACA;QACA;MACA;MACA;QACAF;QACAG;QACAD;MACA,GACA;QACAF;QACAG;QACAD;MACA,EACA;MACA;QACA;UACAF;UACAG;UACAD;QACA;UACAF;UACAG;UACAD;QACA;MACA;QACA;UACAF;UACAG;UACAD;QACA;MACA;IACA;IACAE;MAAA;MACAxB,oCACAC,uFACAQ,aACAgB;QACAvB;MACA,GACAQ,sBAEA;QAAA,IADAP;QAEAvB;QACA;MACA;IACA;IACA8C;MAAA;MACA;QACA;UACA;QACA;QACA;MACA;MACA;QACA;QACA1B,qGACA;UACA;UACA;UACA;QACA;UACAnB;UACA;QACA;MACA;QACAmB;UACAR;UACAmC;UACAf;UACAzC;UACAyD;UACAxB;QACA;UACA;UACA;UACA;QACA;UACAvB;UACA;QACA;MACA;IACA;IACAgD;MACA;IACA;IACAC;MACAlD;MACA;IACA;IACAmD;MACA;QACAlD;UACAmD;QACA;MACA;QACA;QACA;MACA;QACA;QACAnD;UACAmD;QACA;MACA;IACA;IACA;AACA;AACA;IACAC;MACA;QACA;MACA;MACArD;MACA;MACA;MACA;QACA;QACA;MACA;QACA;QACA;MACA;MACAA;MACA;IACA;IACA;AACA;AACA;IACAsD;MACA;MACA;IACA;IACAC;MACAvD;MACA;MACA;IACA;IACAwD;MACA;QACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IAAA,CACA;IACAC;MACA;MACA;MACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACpoBA;AAAA;AAAA;AAAA;AAAquC,CAAgB,ksCAAG,EAAC,C;;;;;;;;;;;ACAzvC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/product/detail.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/product/detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./detail.vue?vue&type=template&id=0e9671aa&\"\nvar renderjs\nimport script from \"./detail.vue?vue&type=script&lang=js&\"\nexport * from \"./detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./detail.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/product/detail.vue\"\nexport default component.exports","export * from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./detail.vue?vue&type=template&id=0e9671aa&\"","var components\ntry {\n  components = {\n    tianGoodsPrice: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/tian-mall/components/tian-goods-price/tian-goods-price\" */ \"@/uni_modules/tian-mall/components/tian-goods-price/tian-goods-price.vue\"\n      )\n    },\n    tianIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/tian-mall/components/tian-icons/tian-icons\" */ \"@/uni_modules/tian-mall/components/tian-icons/tian-icons.vue\"\n      )\n    },\n    tianGoodsSku: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/tian-mall/components/tian-goods-sku/tian-goods-sku\" */ \"@/uni_modules/tian-mall/components/tian-goods-sku/tian-goods-sku.vue\"\n      )\n    },\n    tianGoodsNav: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/tian-mall/components/tian-goods-nav/tian-goods-nav\" */ \"@/uni_modules/tian-mall/components/tian-goods-nav/tian-goods-nav.vue\"\n      )\n    },\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.preloaded\n    ? _vm.item.sku_name && _vm.item.sku_name.length > 0\n    : null\n  var g1 = _vm.preloaded\n    ? _vm.item.group_buying && _vm.allGroupBuying.length > 0\n    : null\n  var g2 = _vm.preloaded ? _vm.description && _vm.description.length > 0 : null\n  var g3 = _vm.preloaded ? _vm.allGroupBuying.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./detail.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"goods-detail-container\" v-if=\"preloaded\">\r\n\t\t<uni-swiper-dot :info=\"item.goods_banner_imgs\" :current=\"current\" field=\"content\" mode=\"round\">\r\n\t\t\t<swiper class=\"swiper-box\" @change=\"change\" :current=\"current\" :autoplay=\"true\">\r\n\t\t\t\t<swiper-item v-for=\"(img,index) in item.goods_banner_imgs\" :key=\"index\">\r\n\t\t\t\t\t<image :src=\"img\" mode=\"aspectFill\" class=\"image\"></image>\r\n\t\t\t\t</swiper-item>\r\n\t\t\t</swiper>\r\n\t\t</uni-swiper-dot>\r\n\t\t<view class=\"bg-white padding-24 padding-top-30\">\r\n\t\t\t<tian-goods-price v-if=\"selectSku._id\" :showMiaosha=\"true\" @refresh=\"loadData()\" :hasCart=\"false\" size=\"big\"\r\n\t\t\t\t:value=\"selectSku\">\r\n\t\t\t</tian-goods-price>\r\n\t\t\t<tian-goods-price v-else :showMiaosha=\"true\" @refresh=\"loadData()\" :hasCart=\"false\" size=\"big\"\r\n\t\t\t\t:value=\"item\"></tian-goods-price>\r\n\t\t\t<view class=\"\" v-if=\"item.miaosha && !item.miaosha.is_begin\">\r\n\t\t\t\t<text>秒杀预告：</text>\r\n\t\t\t\t<uni-dateformat :date=\"item.miaosha.begin_time\" format=\"MM月dd日hh:mm\"></uni-dateformat>\r\n\t\t\t\t<text class=\"margin-left-12\">秒杀价</text>\r\n\t\t\t\t<text class=\"price normal\">{{item.miaosha.price/100}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"margin-top-22\">\r\n\t\t\t\t<text class=\"font-32\">{{item.name}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"desc colorGray font-24 padding-bottom-18 padding-top-8\" v-if=\"item.goods_summary\">\r\n\t\t\t\t<text>{{item.goods_summary}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"ti-flex between margin-top-22\">\r\n\t\t\t\t<tian-icons v-if=\"item.is_real\" type=\"wuliu\" align=\"right\" color=\"#787878\"><text>运费：包邮</text>\r\n\t\t\t\t</tian-icons>\r\n\t\t\t\t<tian-icons type=\"tongji\" align=\"right\" color=\"#787878\"><text>月售：{{item.month_sell_count}}</text>\r\n\t\t\t\t</tian-icons>\r\n\t\t\t\t<tian-icons type=\"kucun\" align=\"right\" color=\"#787878\"><text>库存：{{item.remain_count}}</text>\r\n\t\t\t\t</tian-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"bg-white padding-24 padding-top-30 margin-top-22\" v-if=\"item.sku_name && item.sku_name.length>0\">\r\n\t\t\t<view class=\"ti-flex\" @click=\"openSku()\">\r\n\t\t\t\t<text class=\"sub-title\">已选</text>\r\n\t\t\t\t<text v-if=\"selectSku._id\">{{selectSku.sku_name}}</text>\r\n\t\t\t\t<text v-else>请选择商品规格</text>\r\n\t\t\t\t<view class=\"flex-1\">\r\n\r\n\t\t\t\t</view>\r\n\t\t\t\t<tian-icons type=\"xiangyou1\" align=\"right\" color=\"#787878\"></tian-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 拼团 -->\r\n\t\t<view class=\"\" v-if=\"item.group_buying && allGroupBuying.length>0\">\r\n\t\t\t<view class=\"bg-white margin-top-22 \">\r\n\t\t\t\t<view class=\"ti-flex under-line sub-nav-title normal\" @click=\"showMoreGb\">\r\n\t\t\t\t\t<text class=\"flex-1\">{{groupBuyingTotal}}人在拼单，可直接参与</text>\r\n\t\t\t\t\t<tian-icons type=\"xiangyou1\" align=\"left\" color=\"#787878\">查看全部</tian-icons>\r\n\t\t\t\t</view>\r\n\t\t\t\t<groupBuyingPage :groupBuying=\"groupBuying\" @click=\"btnGroupBuying\"></groupBuyingPage>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<!-- 店铺信息 -->\r\n\t\t<view class=\"bg-white ti-flex margin-top-22 padding-22\" v-if=\"item.shop && item.shop._id && customer.isMultiShop\"\r\n\t\t\t@click=\"navTo('/pages/product/shop?id='+item.shop._id,item.shop)\">\r\n\t\t\t<image :src=\"item.shop.src\" mode=\"aspectFill\" class=\"image-width-80 border-radius\"></image>\r\n\t\t\t<view class=\"flex-1 margin-left-16\">\r\n\t\t\t\t<text class=\"font-bold\">{{item.shop.name}}</text>\r\n\t\t\t\t<view class=\"font-24\">\r\n\t\t\t\t\t<text>评分</text>\r\n\t\t\t\t\t<text class=\"colorRed margin-left-4\">{{item.shop.score_text}}</text>\r\n\t\t\t\t\t<text class=\"margin-left-10\">月售</text>\r\n\t\t\t\t\t<text class=\"colorRed margin-left-4\">{{item.shop.month_sell_text}}</text>\r\n\t\t\t\t\t<!-- <text class=\"margin-left-10\">关注</text>\r\n\t\t\t\t\t<text class=\"colorRed margin-left-4\">{{item.shop.focus_text}}</text>\r\n\t\t\t\t\t<text class=\"margin-left-4\">人</text> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<tian-icons type=\"xiangyou1\"></tian-icons>\r\n\t\t</view>\r\n\t\t<view class=\"margin-top-22\"></view>\r\n\t\t<view class=\"bg-white \" v-if=\"item.coupons\">\r\n\t\t\t<view class=\"sub-nav-title under-line ti-flex\">\r\n\t\t\t\t<text>优惠券</text>\r\n\t\t\t\t<view class=\"flex-1\"></view>\r\n\t\t\t\t<tian-icons type=\"xiangyou1\" size=\"12\" align=\"left\" @click=\"showCoupon\">\r\n\t\t\t\t\t<text class=\"font-24 colorWhite\"\r\n\t\t\t\t\t\tstyle=\"font-weight: 400;background: #dd524d;padding:0rpx 20rpx;border-radius: 12rpx;\">去领取优惠券</text>\r\n\t\t\t\t</tian-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"bg-white\">\r\n\t\t\t<view class=\"sub-nav-title under-line ti-flex\">\r\n\t\t\t\t<text>商品评价</text>\r\n\t\t\t\t<text v-if=\"item.comment_count\">（{{item.comment_count}}）</text>\r\n\t\t\t\t<view class=\"flex-1\">\r\n\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<tian-icons type=\"xiangyou1\" size=\"12\" align=\"left\"\r\n\t\t\t\t\t@click=\"navTo('/pages/product/comment?id='+item._id,item)\">\r\n\t\t\t\t\t<text class=\"font-24 colorGray\" style=\"font-weight: 400;\">好评度{{item.commentGoodRate}}%</text>\r\n\t\t\t\t</tian-icons>\r\n\r\n\t\t\t</view>\r\n\t\t\t<view class=\"\" v-if=\"item.comment_count\">\r\n\t\t\t\t<view v-for=\"(comment,index) in item.comments\" :key=\"index\"\r\n\t\t\t\t\tclass=\"margin-bottom-22 under-line padding-22\">\r\n\t\t\t\t\t<view class=\"ti-flex\">\r\n\t\t\t\t\t\t<image :src=\"comment.user.avatar\" mode=\"aspectFill\" class=\"user-avatar\"></image>\r\n\t\t\t\t\t\t<view class=\"margin-left-12\">\r\n\t\t\t\t\t\t\t<view class=\"\">\r\n\t\t\t\t\t\t\t\t<text>{{comment.user.nickname}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<uni-rate size=\"12\" :value=\"comment.rate\" readonly class=\"\"></uni-rate>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"font-24 margin-top-6 padding-lr-10\">\r\n\t\t\t\t\t\t<text>{{comment.content}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view v-else class=\"text-center padding-24\">\r\n\t\t\t\t<text>暂无评价</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"bg-white margin-top-22\" v-if=\"description && description.length>0\">\r\n\t\t\t<view class=\"sub-nav-title under-line\"><text>图文详情</text></view>\r\n\t\t\t<view v-for=\"(item,index) in description\" :key=\"index\">\r\n\t\t\t\t<j-video v-if=\"item.type=='video'\" :url=\"item.content\" height=\"220px\" width=\"750rpx\"></j-video>\r\n\t\t\t\t<rich-text v-else :nodes=\"item.content\"></rich-text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"bg-white margin-top-22\">\r\n\t\t\t<view class=\"sub-nav-title under-line\"><text>价格说明</text></view>\r\n\t\t\t<view class=\"padding-24\" style=\"line-height: 1.5;\">\r\n\t\t\t\t<text>权利说明：</text>\r\n\t\t\t\t<view v-for=\"(item,index) in quanyiDescription\" :key=\"index\" class=\"font-20 colorGray\">\r\n\t\t\t\t\t<text>{{item}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"padding-24\" style=\"line-height: 1.5;\">\r\n\t\t\t\t<text>价格说明：</text>\r\n\t\t\t\t<view v-for=\"(item,index) in priceDescription\" :key=\"index\" class=\"font-20 colorGray\">\r\n\t\t\t\t\t<text>{{item}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<block v-if=\"loaded\">\r\n\t\t\t<tian-goods-sku :value=\"item\" :group_buying_id=\"group_buying_id\" :sid=\"defaultSkuId\" ref=\"tianSkuPop\"\r\n\t\t\t\t:isSubmitSku=\"isSubmitSku\" @change=\"changeSku\"></tian-goods-sku>\r\n\t\t\t<view class=\"goods-carts\" :style=\"bottomStyle\">\r\n\t\t\t\t<tian-goods-nav :options=\"bottomOptions\" :buttonGroup=\"buttonGroup\" :fill=\"true\" @click=\"leftClick\"\r\n\t\t\t\t\t@buttonClick=\"buttonClick\">\r\n\t\t\t\t</tian-goods-nav>\r\n\t\t\t</view>\r\n\t\t</block>\r\n\t\t<uni-popup ref=\"gbPopup\" type=\"center\" @change=\"changeGb\">\r\n\t\t\t<view class=\"bg-white border-radius\">\r\n\t\t\t\t<view class=\"closeGb\">\r\n\t\t\t\t\t<tian-icons type=\"guanbi2\" @click=\"closeGb()\" size=\"26\" class=\"\"></tian-icons>\r\n\t\t\t\t</view>\r\n\t\t\t\t<scroll-view scroll-y=\"true\" style=\"max-height: 300px;min-height: 200px;\">\r\n\t\t\t\t\t<groupBuyingPage :groupBuying=\"allGroupBuying\" @click=\"btnGroupBuying\"></groupBuyingPage>\r\n\t\t\t\t\t<view class=\"padding-20 text-center font-20 colorGray\"\r\n\t\t\t\t\t\tv-if=\"allGroupBuying.length==maxShowAllGroupBuying\">\r\n\t\t\t\t\t\t<text>仅显示{{maxShowAllGroupBuying}}个可参与的拼单</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t\t<uni-popup ref=\"couponPopup\" type=\"bottom\" :safeArea=\"false\">\r\n\t\t\t<view class=\"bg-white border-radius padding-22 padding-top-100 popup\">\r\n\t\t\t\t<view class=\"closeGb\">\r\n\t\t\t\t\t<tian-icons type=\"guanbi2\" @click=\"closeCoupon()\" size=\"26\" class=\"\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<scroll-view scroll-y=\"true\" style=\"max-height: 300px;min-height: 200px;\">\r\n\t\t\t\t\t<tian-coupons :value=\"item.coupons\" @close=\"closeCoupon\"></tian-coupons>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tconst db = uniCloud.database();\r\n\timport tabbarMixin from '../index/mixin/tabbar';\r\n\timport groupBuyingPage from './components/group-buying.vue';\r\n\timport mpShareMixin from '@/common/mixin/share/mp';\r\n\texport default {\r\n\t\tmixins: [tabbarMixin, mpShareMixin],\r\n\t\tcomponents: {\r\n\t\t\tgroupBuyingPage,\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpreloaded: false,\r\n\t\t\t\tloaded: false,\r\n\t\t\t\tcurrent: 0,\r\n\t\t\t\tbottomOptions: [],\r\n\t\t\t\tbuttonGroup: [],\r\n\t\t\t\tselectSku: {},\r\n\t\t\t\tdefaultSkuId: \"\",\r\n\t\t\t\tgroup_buying_id: \"\",\r\n\t\t\t\titem: {},\r\n\t\t\t\tdescription: [],\r\n\t\t\t\tdefaultPrice: 0,\r\n\t\t\t\tallGroupBuying: [],\r\n\t\t\t\tgroupBuying: [],\r\n\t\t\t\tgroupBuyingTotal: 0,\r\n\t\t\t\tmaxShowAllGroupBuying: 10,\r\n\t\t\t\tisSubmitSku: 0\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad(e) {\r\n\t\t\t//只有商品id\r\n\t\t\tthis.item = this.getItemData();\r\n\t\t\tif (!this.item) {\r\n\t\t\t\tthis.item = {}\r\n\t\t\t}\r\n\t\t\tif (this.item._id) {\r\n\t\t\t\t// this.loaded = true;\r\n\t\t\t\tthis.preloaded = true;\r\n\t\t\t}\r\n\t\t\tif (e.id) {\r\n\t\t\t\tthis.item._id = e.id;\r\n\t\t\t}\r\n\t\t\t//默认选中规格\r\n\t\t\tif (e.sku) {\r\n\t\t\t\tthis.defaultSkuId = e.sku;\r\n\t\t\t\tthis.defaultPrice = e.price;\r\n\t\t\t}\r\n\t\t\t//临时用一下轮播图\r\n\t\t\tif (this.item.goods_thumb) {\r\n\t\t\t\tthis.item.goods_banner_imgs = [this.$thumbImg(this.item.goods_thumb, '750x750')];\r\n\t\t\t}\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\t//下拉刷新\r\n\t\tonPullDownRefresh() {\r\n\t\t\tconsole.log('刷新整页');\r\n\t\t\tuni.stopPullDownRefresh();\r\n\t\t\tthis.current = 0;\r\n\t\t\tthis.updateBottomOptions();\r\n\t\t\tthis.loadData()\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tif (this.loaded) {\r\n\t\t\t\tthis.getGroupBuying();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tquanyiDescription() {\r\n\t\t\t\tif (this.$store.state.app.customer.goods && this.$store.state.app.customer.goods.priceDescription.quanyi) {\r\n\t\t\t\t\treturn this.$store.state.app.customer.goods.priceDescription.quanyi\r\n\t\t\t\t}\r\n\t\t\t\treturn []\r\n\t\t\t},\r\n\t\t\tcustomer() {\r\n\t\t\t\tif (this.$store.state.app.customer) {\r\n\t\t\t\t\treturn this.$store.state.app.customer\r\n\t\t\t\t}\r\n\t\t\t\treturn {}\r\n\t\t\t},\r\n\t\t\tpriceDescription() {\r\n\t\t\t\tif (this.$store.state.app.customer.goods && this.$store.state.app.customer.goods.priceDescription.price) {\r\n\t\t\t\t\treturn this.$store.state.app.customer.goods.priceDescription.price\r\n\t\t\t\t}\r\n\t\t\t\treturn []\r\n\t\t\t},\r\n\t\t\tbottomStyle() {\r\n\t\t\t\tlet bottom = 0;\r\n\t\t\t\t//苹果10以后才有这个高度\r\n\t\t\t\tif (this.systemInfo.model.indexOf('iPhone 1') == 0 || this.systemInfo.model.indexOf('iPhone X') == 0) {\r\n\t\t\t\t\tbottom = this.systemInfo.safeAreaInsets.bottom;\r\n\t\t\t\t\tif (bottom > this.systemInfo.safeArea.bottom) {\r\n\t\t\t\t\t\tbottom = this.systemInfo.safeArea.bottom;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbottom = bottom - 20;\r\n\t\t\t\t}\r\n\t\t\t\treturn `background-color: #fff;padding-bottom:${bottom}rpx`;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowCoupon() {\r\n\t\t\t\tthis.$refs.couponPopup.open();\r\n\t\t\t},\r\n\t\t\tgetCoupon(item) {\r\n\t\t\t\tthis.$request(\r\n\t\t\t\t\t'mall/coupon/takeit', {\r\n\t\t\t\t\t\tid: item._id,\r\n\t\t\t\t\t\tshop_id: this.item.shop_id\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tloading: true\r\n\t\t\t\t\t}\r\n\t\t\t\t).then(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '领取成功',\r\n\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\tthis.closeCoupon();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: err.message || '领取失败',\r\n\t\t\t\t\t\t\tshowCancel: false,\r\n\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\tthis.closeCoupon();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tcloseCoupon() {\r\n\t\t\t\tthis.$refs.couponPopup.close();\r\n\t\t\t},\r\n\t\t\tloadData() {\r\n\t\t\t\tdb.action(\"goods_miaosha,goods_member,check_goods_favorite,goods_visite,goods_coupon\").collection(\"opendb-mall-goods\")\r\n\t\t\t\t\t.where(\r\n\t\t\t\t\t\t`_id==\"${this.item._id}\"`).field(\r\n\t\t\t\t\t\t\"goods_sn,name,category_id,shop_id,keywords,comments,comment_total_rate,miaosha,goods_desc,goods_thumb,goods_summary,goods_banner_imgs,price,market_price,sku_name,is_vip,remain_count,month_sell_count,total_sell_count,comment_count,is_real,is_on_sale,is_alone_sale,is_best,is_new,is_hot,add_date,last_modify_date,use_score,use_score_rate,group_buying,group_buying_discount\"\r\n\t\t\t\t\t).get({\r\n\t\t\t\t\t\tgetOne: true\r\n\t\t\t\t\t}).then(({\r\n\t\t\t\t\t\tresult\r\n\t\t\t\t\t}) => {\r\n\t\t\t\t\t\tthis.description = [];\r\n\t\t\t\t\t\t//处理商品图文混排\r\n\t\t\t\t\t\tif (result.data.goods_desc && result.data.goods_desc.length > 0) {\r\n\t\t\t\t\t\t\tlet imgsExtRegex = new RegExp(\"(.jpg|.png|.jpeg|.gif)$\");\r\n\t\t\t\t\t\t\tlet videoExtRegex = new RegExp(\"(.mp4|.wma|.3gp)$\");\r\n\t\t\t\t\t\t\t//如果是http开头的，是资源文件，可能是图片、视频\r\n\t\t\t\t\t\t\tlet contents = [];\r\n\t\t\t\t\t\t\tresult.data.goods_desc.map(e => {\r\n\t\t\t\t\t\t\t\tif (e.indexOf(\"http\") > -1) {\r\n\t\t\t\t\t\t\t\t\tif (videoExtRegex.test(e.toLowerCase())) {\r\n\t\t\t\t\t\t\t\t\t\tif (contents.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.description.push({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"html\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontent: contents.join(\"\")\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tcontents = [];\r\n\t\t\t\t\t\t\t\t\t\tthis.description.push({\r\n\t\t\t\t\t\t\t\t\t\t\ttype: \"video\",\r\n\t\t\t\t\t\t\t\t\t\t\tcontent: e\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t//可能存在没有后缀的图片\r\n\t\t\t\t\t\t\t\t\tcontents.push(`<img src=\"${e}\" style=\"width:100%;display:block;\"/>`);\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcontents.push(`<p style=\"padding:12px;\">${e}</p>`);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (contents.length > 0) {\r\n\t\t\t\t\t\t\t\tthis.description.push({\r\n\t\t\t\t\t\t\t\t\ttype: \"html\",\r\n\t\t\t\t\t\t\t\t\tcontent: contents.join(\"\")\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(this.description)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//从其他地方传递过来的价格\r\n\t\t\t\t\t\tif (this.defaultPrice) {\r\n\t\t\t\t\t\t\tresult.data.price = this.defaultPrice;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//封面图填充为第一张轮播图，显示效果最佳\r\n\t\t\t\t\t\tif (!result.data.goods_banner_imgs) {\r\n\t\t\t\t\t\t\tresult.data.goods_banner_imgs = []\r\n\t\t\t\t\t\t\tresult.data.goods_banner_imgs.unshift(result.data.goods_thumb)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.item = result.data;\r\n\t\t\t\t\t\tthis.preloaded = true;\r\n\t\t\t\t\t\tthis.loaded = true;\r\n\t\t\t\t\t\tthis.buildData();\r\n\t\t\t\t\t\tthis.updateBottomOptions()\r\n\t\t\t\t\t\tthis.getGroupBuying();\r\n\t\t\t\t\t\tthis.setGlobalShareContent(false, {\r\n\t\t\t\t\t\t\tgoods: result.data\r\n\t\t\t\t\t\t}, \"product/detail\")\r\n\t\t\t\t\t});\r\n\t\t\t\tthis.updateBottomOptions();\r\n\t\t\t\tif (this.$store.state.app && this.$store.state.app.customer && this.$store.state.app.customer\r\n\t\t\t\t\t.maxShowAllGroupBuying) {\r\n\t\t\t\t\tthis.maxShowAllGroupBuying = this.$store.state.app.customer.maxShowAllGroupBuying\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbuildData(item) {\r\n\t\t\t\t//处理轮播图\r\n\t\t\t\tif (this.item.goods_banner_imgs) {\r\n\t\t\t\t\tthis.item.goods_banner_imgs = this.item.goods_banner_imgs.map(img => {\r\n\t\t\t\t\t\treturn this.$thumbImg(img, '750x750');\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 商品拼单信息\r\n\t\t\t */\r\n\t\t\tgetGroupBuying() {\r\n\t\t\t\tif (!this.item.group_buying) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet info = this.$store.state.user.userInfo;\r\n\t\t\t\tdb.collection(\"opendb-mall-goods-group-buying,uni-id-users\").where(\r\n\t\t\t\t\t\t`goods_id==\"${this.item._id}\" && state==1`)\r\n\t\t\t\t\t.field(\r\n\t\t\t\t\t\t\"group_id,user_id.avatar,user_id._id,user_id.nickname,end_time\").orderBy(\"create_time asc\").get()\r\n\t\t\t\t\t.then(({\r\n\t\t\t\t\t\tresult\r\n\t\t\t\t\t}) => {\r\n\t\t\t\t\t\tconsole.log(result)\r\n\t\t\t\t\t\t//分组\r\n\t\t\t\t\t\tlet dataMap = {};\r\n\t\t\t\t\t\tthis.groupBuyingTotal = 0;\r\n\t\t\t\t\t\tresult.data.map(item => {\r\n\t\t\t\t\t\t\t//处理用户数据\r\n\t\t\t\t\t\t\tlet userinfo = this.buildUserInfo(item.user_id[0]);\r\n\t\t\t\t\t\t\tif (!dataMap[item.group_id]) {\r\n\t\t\t\t\t\t\t\tdataMap[item.group_id] = {\r\n\t\t\t\t\t\t\t\t\tavatar: [],\r\n\t\t\t\t\t\t\t\t\tnickname: [],\r\n\t\t\t\t\t\t\t\t\tid: item.group_id,\r\n\t\t\t\t\t\t\t\t\tenable: true,\r\n\t\t\t\t\t\t\t\t\tindex: this.item.group_buying,\r\n\t\t\t\t\t\t\t\t\tamount: this.item.group_buying,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdataMap[item.group_id].index--;\r\n\t\t\t\t\t\t\t//不能自己给自己拼单 \r\n\t\t\t\t\t\t\tif (userinfo._id == info._id) {\r\n\t\t\t\t\t\t\t\tdataMap[item.group_id].enable = false;\r\n\t\t\t\t\t\t\t\tdataMap[item.group_id].index += 1000;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdataMap[item.group_id].avatar.push(userinfo.avatar)\r\n\t\t\t\t\t\t\tdataMap[item.group_id].nickname.push(userinfo.nickname)\r\n\t\t\t\t\t\t\tdataMap[item.group_id].amount--;\r\n\t\t\t\t\t\t\tthis.groupBuyingTotal++;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.allGroupBuying = [];\r\n\t\t\t\t\t\t//所有拼单\r\n\t\t\t\t\t\tlet gb = [];\r\n\t\t\t\t\t\tfor (let id in dataMap) {\r\n\t\t\t\t\t\t\tif (this.allGroupBuying.length < this.maxShowAllGroupBuying) {\r\n\t\t\t\t\t\t\t\tthis.allGroupBuying.push(dataMap[id]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//按参与人数排序\r\n\t\t\t\t\t\tthis.allGroupBuying.sort((a, b) => {\r\n\t\t\t\t\t\t\treturn a.index - b.index;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t//外面只显示2条\r\n\t\t\t\t\t\tthis.allGroupBuying.map(g => {\r\n\t\t\t\t\t\t\tif (gb.length < 2) {\r\n\t\t\t\t\t\t\t\tgb.push(g);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t//只显示2条\r\n\t\t\t\t\t\tthis.groupBuying = gb;\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tupdateBottomOptions() {\r\n\t\t\t\tlet options = [{\r\n\t\t\t\t\ticon: 'dianpu',\r\n\t\t\t\t\ttext: '首页',\r\n\t\t\t\t}];\r\n\t\t\t\tif (this.item.is_on_sale) {\r\n\t\t\t\t\tif (this.item.is_fav) {\r\n\t\t\t\t\t\toptions.push({\r\n\t\t\t\t\t\t\ticon: 'biaoxingfill',\r\n\t\t\t\t\t\t\tcolor: \"#ff5a1d\",\r\n\t\t\t\t\t\t\ttext: '已收藏'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toptions.push({\r\n\t\t\t\t\t\t\ticon: 'biaoxing',\r\n\t\t\t\t\t\t\tcolor: \"#646566\",\r\n\t\t\t\t\t\t\ttext: '收 藏'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\toptions.push({\r\n\t\t\t\t\ticon: 'gouwuche',\r\n\t\t\t\t\ttext: '购物车',\r\n\t\t\t\t\t// info: this.cartCount\r\n\t\t\t\t})\r\n\t\t\t\tthis.bottomOptions = options;\r\n\t\t\t\tif (!this.item.is_on_sale) {\r\n\t\t\t\t\tthis.buttonGroup = [{\r\n\t\t\t\t\t\ttext: '商品已下架',\r\n\t\t\t\t\t\tbackgroundColor: '#878787',\r\n\t\t\t\t\t\tcolor: '#fff'\r\n\t\t\t\t\t}];\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.buttonGroup = [{\r\n\t\t\t\t\t\ttext: '加入购物车',\r\n\t\t\t\t\t\tbackgroundColor: '#ffa200',\r\n\t\t\t\t\t\tcolor: '#fff'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: '立即购买',\r\n\t\t\t\t\t\tbackgroundColor: '#ff0000',\r\n\t\t\t\t\t\tcolor: '#fff'\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t\tif (this.item.group_buying) {\r\n\t\t\t\t\tthis.buttonGroup = [{\r\n\t\t\t\t\t\ttext: '立即购买',\r\n\t\t\t\t\t\tbackgroundColor: '#aeaeae',\r\n\t\t\t\t\t\tcolor: '#fff'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttext: '拼单购买',\r\n\t\t\t\t\t\tbackgroundColor: '#e64340',\r\n\t\t\t\t\t\tcolor: '#fff'\r\n\t\t\t\t\t}];\r\n\t\t\t\t} else if (!this.item.is_real) {\r\n\t\t\t\t\tthis.buttonGroup = [{\r\n\t\t\t\t\t\ttext: '立即购买',\r\n\t\t\t\t\t\tbackgroundColor: '#ff0000',\r\n\t\t\t\t\t\tcolor: '#fff'\r\n\t\t\t\t\t}];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcheckFav() {\r\n\t\t\t\tdb.collection('tian-mall-favorite')\r\n\t\t\t\t\t.where(`user_id==$cloudEnv_uid && type=='goods' && id==\"${this.item._id}\"`)\r\n\t\t\t\t\t.field('_id')\r\n\t\t\t\t\t.get({\r\n\t\t\t\t\t\tgetOne: true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(({\r\n\t\t\t\t\t\tresult\r\n\t\t\t\t\t}) => {\r\n\t\t\t\t\t\tconsole.log('checkFav result', result.data);\r\n\t\t\t\t\t\tthis.is_fav = !!result.data;\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tsaveFav() {\r\n\t\t\t\tif (!this.isLogin) {\r\n\t\t\t\t\tthis.navToLoginNotice(() => {\r\n\t\t\t\t\t\tthis.checkFav();\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.item.is_fav) {\r\n\t\t\t\t\t//取消收藏\r\n\t\t\t\t\tdb.collection(\"tian-mall-favorite\").where(\r\n\t\t\t\t\t\t`user_id==$cloudEnv_uid && type=='goods' && id==\"${this.item._id}\"`).remove().then(() => {\r\n\t\t\t\t\t\tthis.$success(\"取消成功\")\r\n\t\t\t\t\t\tthis.item.is_fav = false;\r\n\t\t\t\t\t\tthis.updateBottomOptions()\r\n\t\t\t\t\t}).catch(() => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.$message(\"取消失败\")\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdb.collection(\"tian-mall-favorite\").add({\r\n\t\t\t\t\t\tid: this.item._id,\r\n\t\t\t\t\t\ttitle: this.item.name,\r\n\t\t\t\t\t\tavatar: this.item.goods_thumb,\r\n\t\t\t\t\t\tdescription: this.item.goods_summary,\r\n\t\t\t\t\t\tprice: this.item.price,\r\n\t\t\t\t\t\ttype: [\"goods\"],\r\n\t\t\t\t\t}).then(() => {\r\n\t\t\t\t\t\tthis.$success(\"收藏成功\")\r\n\t\t\t\t\t\tthis.item.is_fav = true;\r\n\t\t\t\t\t\tthis.updateBottomOptions()\r\n\t\t\t\t\t}).catch(() => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.$message(\"收藏失败\")\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchange(e) {\r\n\t\t\t\tthis.current = e.detail.current;\r\n\t\t\t},\r\n\t\t\tresetTabCartCount() {\r\n\t\t\t\tconsole.log(\"resetTabCartCount\")\r\n\t\t\t\tthis.updateBottomOptions()\r\n\t\t\t},\r\n\t\t\tleftClick(e) {\r\n\t\t\t\tif (e.index == 0) {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: \"/pages/index/index\"\r\n\t\t\t\t\t})\r\n\t\t\t\t} else if (e.index == 1) {\r\n\t\t\t\t\t//收藏\r\n\t\t\t\t\tthis.saveFav()\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 跳转购物车\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: \"/pages/index/cart\"\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 点加入购物车或者立即购买打开规格弹窗\r\n\t\t\t */\r\n\t\t\tbuttonClick(e) {\r\n\t\t\t\tif (!this.item.is_on_sale) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"buttonClick\", e.index, this.item)\r\n\t\t\t\t//订单类型：0加入购物车，1直接购买，2拼单购买，3虚拟商品购买\r\n\t\t\t\tthis.isSubmitSku = e.index + 1;\r\n\t\t\t\tif (this.item.group_buying) {\r\n\t\t\t\t\tthis.isSubmitSku = e.index + 2;\r\n\t\t\t\t\tthis.group_buying_id = \"\"\r\n\t\t\t\t} else if (!this.item.is_real) {\r\n\t\t\t\t\t//非实物购买\r\n\t\t\t\t\tthis.isSubmitSku = 4;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"this.isSubmitSku\", this.isSubmitSku)\r\n\t\t\t\tthis.$refs.tianSkuPop.open();\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 直接打开规格弹窗\r\n\t\t\t */\r\n\t\t\topenSku() {\r\n\t\t\t\tthis.isSubmitSku = 0;\r\n\t\t\t\tthis.$refs.tianSkuPop.open();\r\n\t\t\t},\r\n\t\t\tchangeSku(sku) {\r\n\t\t\t\tconsole.log(\"changeSku\", sku)\r\n\t\t\t\tthis.selectSku = sku;\r\n\t\t\t\t// this.item.price = sku.price;\r\n\t\t\t},\r\n\t\t\tshowMoreGb() {\r\n\t\t\t\tif (this.allGroupBuying.length > 0) {\r\n\t\t\t\t\tthis.$refs.gbPopup.open();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcloseGb() {\r\n\t\t\t\tthis.$refs.gbPopup.close();\r\n\t\t\t},\r\n\t\t\tchangeGb(e) {\r\n\t\t\t\t// console.log(\"changeGb\", e)\r\n\t\t\t},\r\n\t\t\tbtnGroupBuying(id) {\r\n\t\t\t\tthis.$refs.gbPopup.close();\r\n\t\t\t\tthis.isSubmitSku = 4;\r\n\t\t\t\tthis.group_buying_id = id;\r\n\t\t\t\tthis.$refs.tianSkuPop.open();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.goods-detail-container {\r\n\t\tpadding-bottom: 120rpx;\r\n\r\n\t\t.swiper-box {\r\n\t\t\theight: 750rpx;\r\n\t\t}\r\n\r\n\t\t.image {\r\n\t\t\twidth: 750rpx;\r\n\t\t\theight: 750rpx;\r\n\t\t}\r\n\r\n\t\t.goods-carts {\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\tposition: fixed;\r\n\t\t\tz-index: 101;\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t\tleft: var(--window-left);\r\n\t\t\tright: var(--window-right);\r\n\t\t\tbottom: 0;\r\n\t\t}\r\n\r\n\t\t.sub-title {\r\n\t\t\twidth: 88rpx;\r\n\t\t\tcolor: #aaaaaa;\r\n\t\t}\r\n\r\n\t\t.sub-nav-title {\r\n\t\t\tpadding: 18rpx 24rpx 18rpx;\r\n\t\t\tfont-weight: 600;\r\n\r\n\t\t\t&.normal {\r\n\t\t\t\tfont-weight: normal;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.user-avatar {\r\n\t\t\tposition: relative;\r\n\t\t\tz-index: 100;\r\n\t\t}\r\n\r\n\t\t.more-avatar {\r\n\t\t\tmargin-left: -30rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.closeGb {\r\n\t\tposition: absolute;\r\n\t\tright: -14px;\r\n\t\ttop: -14px;\r\n\t}\r\n\r\n\t.popup {\r\n\t\tpadding-bottom: var(--window-bottom);\r\n\t}\r\n</style>\n","import mod from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./detail.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!G:\\\\software\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./detail.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1682514326959\n      var cssReload = require(\"G:/software/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}